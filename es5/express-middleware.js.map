{"version":3,"sources":["../lib/express-middleware.js"],"names":[],"mappings":";;;;;;;;qBAAwB,eAAe;;AAAxB,SAAS,eAAe,CAAC,cAAc,EAAE;AACtD,SAAO,UAAC,GAAG,EAAE,GAAG,EAAE,IAAI,EAAK;AACzB,QAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa,EAAE;AAC9B,aAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,EAAE,OAAO,EAAE,eAAe,EAAE,EAAE,CAAC,CAAC;KACtE;;2CAEyB,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC;;;;QAAvD,QAAQ;QAAE,KAAK;;AAEtB,QAAI,CAAC,QAAQ,IAAI,CAAC,KAAK,EAAE;AACvB,aAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,EAAE,OAAO,EAAE,eAAe,EAAE,EAAE,CAAC,CAAC;KACtE;;AAED,WAAO,cAAc,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,UAAC,MAAM,EAAK;AAC1D,SAAG,CAAC,KAAK,GAAG;AACV,aAAK,EAAL,KAAK;AACL,6BAAqB,EAAE,MAAM,CAAC,qBAAqB;OACpD,CAAC;AACF,aAAO,IAAI,EAAE,CAAC;KACf,CAAC,SAAM,CAAC,YAAM;AACb,aAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,EAAE,OAAO,EAAE,eAAe,EAAE,EAAE,CAAC,CAAC;KACtE,CAAC,CAAC;GACJ,CAAC;CACH","file":"express-middleware.js","sourcesContent":["export default function isAuthenticated(globalIdentity) {\r\n  return (req, res, next) => {\r\n    if (!req.headers.authorization) {\r\n      return res.status(401).json({ error: { message: 'Invalid token' } });\r\n    }\r\n\r\n    const [authType, token] = req.headers.authorization.split(' ');\r\n\r\n    if (!authType || !token) {\r\n      return res.status(401).json({ error: { message: 'Invalid token' } });\r\n    }\r\n\r\n    return globalIdentity.validateToken(token).then((result) => {\r\n      req.token = {\r\n        token,\r\n        expiration_in_minutes: result.expiration_in_minutes,\r\n      };\r\n      return next();\r\n    }).catch(() => {\r\n      return res.status(401).json({ error: { message: 'Invalid token' } });\r\n    });\r\n  };\r\n}\r\n"]}